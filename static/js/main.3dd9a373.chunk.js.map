{"version":3,"sources":["images/tomato.png","images/avocado.gif","components/CardImage.js","components/BuyButton.js","components/PriceButton.js","components/CardPreview.js","pages/Discover.js","pages/Home.js","components/Card.js","pages/Card.js","pages/Account.js","pages/Stats.js","App.js","index.js","images/logo.png"],"names":["module","exports","loadedCards","preloadCard","cardId","Image","src","CardImage","props","useState","loading","setLoading","badCard","setBadCard","cardReady","useEffect","a","onload","onerror","e","className","LoadingCard","alt","BrokenCard","fromNear","s","parseFloat","BuyButton","preventDefault","_near","contract","buy_card","card_id","price","appCommission","artDaoProfit","ownerPrice","ownerId","newPrice","disabled","signedIn","onClick","buyCard","toFixed","PriceButton","to","CardPreview","rating","setRating","propsRating","fetchRating","useCallback","get_rating","connected","then","role","DiscoverPage","feed","setFeed","uuid","gkey","fetchTop","get_top","limit","cards","map","key","HomePage","leftReady","setLeftReady","rightReady","setRightReady","Promise","resolve","votingPromise","voteRequest","requests","slice","forEach","nextRequest","left","right","vote","response","popRequest","request","newRequest","addRecentCard","addRequest","recentCards","length","mapCardInfo","c","owner_id","purchasePrice","purchase_price","purchaseTime","Date","purchase_time","volume","art_dao_profit","numTrades","num_trades","Card","cardInfo","setCardInfo","refreshTime","hidden","fetchInfo","get_card_info","signedAccountId","datetime","CardPage","useParams","parseInt","AccountPage","accountId","account","setAccount","cardIds","setCardsIds","fetchCards","getAccount","numCards","purchaseVolume","numPurchases","saleProfit","numSales","numVotes","StatsPage","stats","setStats","fetchStats","get_trade_data","t","num_purchases","numUniqueCardsBought","num_unique_cards_bought","nearVolume","near_volume","app_owner_profit","appOwnerId","app_owner_id","artDaoId","art_dao_id","totalVotes","total_votes","IsMainnet","window","location","hostname","NearConfig","networkId","nodeUrl","archivalNodeUrl","contractName","walletUrl","mapAccount","num_cards","purchase_volume","sale_profit","num_sales","num_votes","App","lsKey","lsKeyRecentCards","state","isNavCollapsed","ls","get","_initNear","setState","keyStore","nearAPI","BrowserLocalStorageKeyStore","Object","assign","deps","near","this","walletConnection","getAccountId","viewMethods","changeMethods","accounts","get_account","account_id","cardFetching","promises","i","push","get_account_cards","from_index","all","flat","register_account","requestSignIn","signOut","_accountId","r","index","indexOf","splice","unshift","set","passProps","updateState","header","logOut","aria-hidden","basename","process","title","Logo","type","data-bs-toggle","data-bs-target","aria-controls","aria-expanded","aria-label","id","aria-current","href","data-ribbon","exact","path","Stats","Account","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.3dd9a373.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/tomato.9239fac3.png\";","module.exports = __webpack_public_path__ + \"static/media/avocado.f0698336.gif\";","import React, {useEffect, useState} from 'react';\nimport BrokenCard from \"../images/tomato.png\"\nimport LoadingCard from \"../images/avocado.gif\"\n\nconst loadedCards = {};\n\nfunction preloadCard(cardId) {\n  if (cardId in loadedCards) {\n    return;\n  }\n  loadedCards[cardId] = true;\n  let a = new Image();\n  a.src = `https://wayback.berryclub.io/img/${cardId}`;\n}\n\nfunction CardImage(props) {\n  const [loading, setLoading] = useState(true);\n  const [badCard, setBadCard] = useState(false);\n\n  const cardReady = props.cardReady;\n  const cardId = props.cardId;\n\n  useEffect(() => {\n    setLoading(true);\n    setBadCard(false);\n    cardReady(false);\n    let a = new Image();\n    a.src = `https://wayback.berryclub.io/img/${cardId}`;\n    a.onload = () => {\n      setLoading(false);\n      cardReady(true);\n    }\n    a.onerror = (e) => {\n      setBadCard(true);\n      setLoading(false);\n    }\n  }, [cardId, cardReady])\n\n  return loading ? (\n    <img className={props.className} src={LoadingCard} alt={`The card #${cardId} is loading`}/>\n  ) : badCard ? (\n    <img className={props.className} src={BrokenCard} alt={`The card #${cardId} is broken`}/>\n  ) : (\n    <img className={props.className} src={`https://wayback.berryclub.io/img/${cardId}`} alt={`Card #${cardId}`}/>\n  );\n}\n\nexport { preloadCard, CardImage };\n","import React from 'react';\n\nconst fromNear = (s) => parseFloat(s) / 1e24;\n\nfunction BuyButton(props) {\n  async function buyCard(e) {\n    e.preventDefault();\n    await props._near.contract.buy_card({card_id: props.cardId}, \"200000000000000\", props.price);\n  }\n\n  const price = fromNear(props.price);\n  const appCommission = price / 100;\n  let artDaoProfit = price / 10;\n  let ownerPrice = price - appCommission - artDaoProfit;\n  if (!props.ownerId) {\n    artDaoProfit += ownerPrice;\n    ownerPrice = 0;\n  }\n\n  const newPrice = price * 1.2;\n\n  return (\n    <div>\n      <button\n        className=\"btn btn-success\"\n        disabled={!props.signedIn}\n        onClick={(e) => buyCard(e)}\n      >\n        Buy for {price.toFixed(2)} NEAR\n      </button>\n      <div className=\"text-muted text-start\">\n        <p>\n          Price breakdown:\n          <ul>\n            {props.ownerId && (\n              <li>Owner @{props.ownerId} will get {ownerPrice.toFixed(2)} NEAR</li>\n            )}\n            <li>Art DAO will get {artDaoProfit.toFixed(2)} NEAR</li>\n            <li>1% App commission is {appCommission.toFixed(2)} NEAR</li>\n          </ul>\n        </p>\n        <p>\n          The new price will be {newPrice.toFixed(2)} NEAR\n        </p>\n      </div>\n    </div>\n  );\n}\n\nexport { fromNear, BuyButton };\n","import React from 'react';\nimport {fromNear} from \"./BuyButton\";\nimport {Link} from \"react-router-dom\";\n\nfunction PriceButton(props) {\n  return (\n    <div>\n      <Link\n        to={`/c/${props.cardId}`}\n        className=\"btn btn-success\" disabled={!props.signedIn}\n      >\n        {fromNear(props.price).toFixed(2)} NEAR\n      </Link>\n    </div>\n  );\n}\n\nexport default PriceButton;\n","import \"./CardPreview.scss\"\nimport React, {useCallback, useEffect, useState} from 'react';\nimport {CardImage} from \"./CardImage\";\nimport {Link} from \"react-router-dom\";\nimport PriceButton from \"./PriceButton\";\n\nfunction CardPreview(props) {\n  const [rating, setRating] = useState(props.rating);\n  const cardId = props.cardId;\n  const propsRating = props.rating;\n\n  const fetchRating = useCallback(async () => {\n    return await props._near.contract.get_rating({\n      card_id: cardId,\n    })\n  }, [props._near, cardId])\n\n  useEffect(() => {\n    if (props.connected) {\n      if (!propsRating) {\n        fetchRating().then(setRating)\n      } else {\n        setRating(propsRating)\n      }\n    }\n  }, [props.connected, propsRating, fetchRating])\n\n  return props.cardId ? (\n    <div className=\"card card-preview m-2\">\n      <Link to={`/c/${cardId}`}>\n        <CardImage className=\"card-img-top\" cardId={cardId} cardReady={() => false}/>\n      </Link>\n      <div className=\"card-body\">\n        #{cardId}\n      </div>\n      <div className=\"card-footer text-center\">\n        <PriceButton {...props} cardId={cardId} price={rating} />\n      </div>\n    </div>\n  ) : (\n    <div className=\"card card-preview m-2\">\n     <div className=\"d-flex justify-content-center\">\n        <div className=\"spinner-grow\" role=\"status\">\n          <span className=\"visually-hidden\">Loading...</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CardPreview;\n","import \"./Discover.scss\";\nimport React, {useCallback, useEffect, useState} from 'react';\nimport uuid from \"react-uuid\";\nimport CardPreview from \"../components/CardPreview\";\n\nconst FetchLimit = 40;\n\nfunction DiscoverPage(props) {\n  const [loading, setLoading] = useState(true);\n  const [feed, setFeed] = useState([]);\n  const [gkey] = useState(uuid())\n\n  const fetchTop = useCallback(async () => {\n    // const numCards = await props._near.contract.get_num_cards();\n    return await props._near.contract.get_top({\n      limit: FetchLimit,\n    })\n  }, [props._near])\n\n  useEffect(() => {\n    if (props.connected) {\n      setLoading(true);\n      fetchTop().then((feed) => {\n        setFeed(feed);\n        setLoading(false);\n      })\n    }\n  }, [props.connected, fetchTop])\n\n  const cards = feed.map(([rating, cardId]) => {\n    const key = `${gkey}-${cardId}`;\n    return (\n      <CardPreview {...props} key={key} cardId={cardId} rating={rating} />\n    );\n  })\n\n  return (\n    <div>\n      <div className=\"container\">\n        <div className=\"row justify-content-md-center\">\n          {loading ? (\n            <div className=\"col col-12 col-lg-8 col-xl-6\">\n              <div className=\"d-flex justify-content-center\">\n                <div className=\"spinner-grow\" role=\"status\">\n                  <span className=\"visually-hidden\">Loading...</span>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"col\">\n              {cards}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default DiscoverPage;\n","import \"./Home.scss\";\nimport React, {useState} from 'react';\nimport { CardImage, preloadCard } from \"../components/CardImage\";\nimport CardPreview from \"../components/CardPreview\";\nimport uuid from \"react-uuid\";\n\nconst SelectedLeft = \"SelectedLeft\";\nconst SelectedRight = \"SelectedRight\";\nconst Skipped = \"Skipped\";\n\nfunction HomePage(props) {\n  const [leftReady, setLeftReady] = useState(false);\n  const [rightReady, setRightReady] = useState(false);\n  const [votingPromise] = useState(Promise.resolve());\n  const [gkey] = useState(uuid())\n\n  const voteRequest = props.requests ? props.requests[0] : null;\n\n  if (props.requests) {\n    props.requests.slice(1).forEach((nextRequest) => {\n      preloadCard(nextRequest.left);\n      preloadCard(nextRequest.right);\n    });\n  }\n\n  const vote = async (e, voteRequest, response) => {\n    e.preventDefault();\n    if (response === SelectedLeft && !leftReady) {\n      return;\n    }\n    if (response === SelectedRight && !rightReady) {\n      return;\n    }\n    props.popRequest();\n    votingPromise.then(async () => {\n      const newRequest = await props._near.contract.vote({\n        request: voteRequest,\n        response,\n      }, \"100000000000000\");\n      if (response === SelectedLeft || response === SelectedRight) {\n        const cardId = response === SelectedLeft ? voteRequest.left : voteRequest.right;\n        props.addRecentCard(cardId);\n      }\n      props.addRequest(newRequest);\n    });\n  }\n\n  const cards = props.recentCards.map((cardId) => {\n    const key = `${gkey}-${cardId}`;\n    return (\n      <CardPreview {...props} key={key} cardId={cardId} />\n    );\n  })\n\n  return (\n    <div>\n      <div className=\"container\">\n        {voteRequest ? (\n          <div>\n            <h3>Vote</h3>\n            <div className=\"row justify-content-md-center mb-3\">\n              <div className=\"col col-sm-6\">\n                <div\n                  className={`card-picker${!leftReady ? \" disabled\": \"\"}`}\n                  onClick={(e) => vote(e, voteRequest, SelectedLeft)}\n                >\n                  <CardImage className=\"img-fluid\" cardId={voteRequest.left} cardReady={setLeftReady}/>\n                </div>\n              </div>\n              <div className=\"col col-sm-6\">\n                <div\n                  className={`card-picker${!rightReady ? \" disabled\": \"\"}`}\n                  onClick={(e) => vote(e, voteRequest, SelectedRight)}\n                >\n                  <CardImage className=\"img-fluid\" cardId={voteRequest.right} cardReady={setRightReady}/>\n                </div>\n              </div>\n            </div>\n            <div className=\"row justify-content-md-center mb-3\">\n              <button\n                className=\"btn btn-lg btn-danger\"\n                onClick={(e) => vote(e, voteRequest, Skipped)}\n              >Skip both cards</button>\n            </div>\n          </div>\n        ) : (\n          <div className=\"d-flex justify-content-center\">\n            <div className=\"spinner-grow\" role=\"status\">\n              <span className=\"visually-hidden\">Loading...</span>\n            </div>\n          </div>\n        )}\n        <div className=\"row justify-content-md-center mb-3\">\n          {(cards.length > 0) && (\n            <div>\n              <h3>Recent votes</h3>\n              {cards}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default HomePage;\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {BuyButton, fromNear} from \"./BuyButton\";\nimport {CardImage, preloadCard} from \"./CardImage\";\nimport TimeAgo from \"timeago-react\";\nimport {Link} from \"react-router-dom\";\nimport PriceButton from \"./PriceButton\";\n\nconst mapCardInfo = (c) => {\n  return c ? {\n    ownerId: c.owner_id,\n    purchasePrice: fromNear(c.purchase_price),\n    purchaseTime: new Date(parseFloat(c.purchase_time) / 1e6),\n    volume: fromNear(c.volume),\n    artDaoProfit: fromNear(c.art_dao_profit),\n    numTrades: c.num_trades,\n  } : {\n    ownerId: null,\n    purchasePrice: 0,\n    purchaseTime: null,\n    volume: 0,\n    artDaoProfit: 0,\n    numTrades: 0,\n  };\n}\n\nfunction Card(props) {\n  const [cardInfo, setCardInfo] = useState(null);\n  const cardId = props.cardId;\n  const refreshTime = props.refreshTime;\n  const hidden = props.hidden;\n\n  const fetchInfo = useCallback(async () => {\n    const rating = await props._near.contract.get_rating({\n      card_id: cardId,\n    })\n    const cardInfo = mapCardInfo(await props._near.contract.get_card_info({\n      card_id: cardId,\n    }));\n    cardInfo.refreshTime = refreshTime;\n    cardInfo.rating = rating;\n    return cardInfo;\n  }, [props._near, cardId, refreshTime])\n\n  useEffect(() => {\n    if (props.connected && !hidden) {\n      preloadCard(cardId);\n      fetchInfo().then(setCardInfo)\n    }\n  }, [props.connected, fetchInfo, cardId, hidden])\n\n  return cardInfo ? (\n    <div className=\"card m-2\">\n      <CardImage className=\"card-img-top\" cardId={cardId} cardReady={() => false}/>\n      <div className=\"card-body text-start\">\n        <h3>#{cardId}</h3>\n        {cardInfo.ownerId ? (\n          <div>\n            <p>\n              Owned by {cardInfo.ownerId === props.signedAccountId ? \"you\" : (\n                <Link to={`/a/${cardInfo.ownerId}`}>@{cardInfo.ownerId}</Link>\n              )}<br/>\n              Purchased <TimeAgo datetime={cardInfo.purchaseTime} /> for {cardInfo.purchasePrice.toFixed(2)} NEAR<br/>\n            </p>\n            <p>\n              Total card volume {cardInfo.volume.toFixed(2)} NEAR<br/>\n              Art DAO got {cardInfo.artDaoProfit.toFixed(2)} NEAR<br/>\n            </p>\n          </div>\n        ) : (\n          <div>\n            <p>\n              Not owned by anyone.\n            </p>\n          </div>\n        )}\n      </div>\n      <div className=\"card-footer\">\n        <p className=\"card-text text-center\">\n          {cardInfo.ownerId === props.signedAccountId ? (\n            <PriceButton {...props} cardId={cardId} price={cardInfo.rating} />\n          ) : (\n            <BuyButton {...props} cardId={cardId} price={cardInfo.rating} ownerId={cardInfo.ownerId} />\n          )}\n        </p>\n      </div>\n    </div>\n  ) : (\n    <div className=\"card m-2\">\n      <div className=\"d-flex justify-content-center\">\n        <div className=\"spinner-grow\" role=\"status\">\n          <span className=\"visually-hidden\">Loading...</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Card;\n","import React from 'react';\nimport {useParams} from \"react-router\";\nimport Card from \"../components/Card\";\n\nfunction CardPage(props) {\n  const { cardId } = useParams();\n\n  return (\n    <div className=\"container\">\n      <div className=\"row\">\n        <div className=\"col col-12 col-lg-8 col-xl-6\">\n          <Card {...props} cardId={parseInt(cardId)} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CardPage;\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {useParams} from \"react-router\";\nimport CardPreview from \"../components/CardPreview\";\nimport uuid from \"react-uuid\";\n\nfunction AccountPage(props) {\n  const { accountId } = useParams();\n  const [account, setAccount] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [cardIds, setCardsIds] = useState([]);\n  const [gkey] = useState(uuid());\n\n  const fetchCards = useCallback(async () => {\n    const account = await props._near.getAccount(accountId);\n    if (!account) {\n      return;\n    }\n    setAccount(account);\n    return await account.fetchCards();\n  }, [props._near, accountId])\n\n  useEffect(() => {\n    if (props.connected) {\n      fetchCards().then((cardIds) => {\n        setCardsIds(cardIds);\n        setLoading(false);\n      })\n    }\n  }, [props.connected, fetchCards])\n\n  const cards = cardIds.map((cardId) => {\n    const key = `${gkey}-${cardId}`;\n    return (\n      <CardPreview {...props} key={key} cardId={cardId} />\n    );\n  })\n\n  return (\n    <div className=\"container\">\n      <div className=\"row justify-content-md-center\">\n        {loading ? (\n          <div className=\"col\">\n            <div className=\"d-flex justify-content-center\">\n              <div className=\"spinner-grow\" role=\"status\">\n                <span className=\"visually-hidden\">Loading...</span>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"col \">\n            <h3>{accountId === props.signedAccountId ? \"Your cards\" : `Cards owned by @${accountId}`}</h3>\n            <div>\n              {cards}\n            </div>\n          </div>\n        )}\n        {!account ? (\n          <div className=\"col col-12 col-lg-8 col-xl-6\">\n            <div className=\"d-flex justify-content-center\">\n              <div className=\"spinner-grow\" role=\"status\">\n                <span className=\"visually-hidden\">Loading...</span>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"col col-12 col-lg-4 col-xl-4\">\n            <h3>Stats</h3>\n            <p>\n              <ul>\n                <li>Card owned: {account.numCards}</li>\n                <li>Purchase volume: {account.purchaseVolume.toFixed(2)} NEAR</li>\n                <li>Num purchases: {account.numPurchases}</li>\n                <li>Sale profit: {account.saleProfit.toFixed(2)} NEAR</li>\n                <li>Num sales: {account.numSales}</li>\n                <li>Num votes: {account.numVotes}</li>\n              </ul>\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default AccountPage;\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {fromNear} from \"../components/BuyButton\";\n\nfunction StatsPage(props) {\n  const [stats, setStats] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  const fetchStats = useCallback(async () => {\n    const t = await props._near.contract.get_trade_data();\n    return {\n      numPurchases: t.num_purchases,\n      numUniqueCardsBought: t.num_unique_cards_bought,\n      nearVolume: fromNear(t.near_volume),\n      appCommission: fromNear(t.app_owner_profit),\n      artDaoProfit: fromNear(t.art_dao_profit),\n      appOwnerId: t.app_owner_id,\n      artDaoId: t.art_dao_id,\n      totalVotes: t.total_votes,\n    };\n  }, [props._near])\n\n  useEffect(() => {\n    if (props.connected) {\n      fetchStats().then((stats) => {\n        setStats(stats);\n        setLoading(false);\n      })\n    }\n  }, [props.connected, fetchStats])\n\n  return (\n    <div className=\"container\">\n      <div className=\"row\">\n        {loading ? (\n          <div className=\"col\">\n            <div className=\"d-flex justify-content-center\">\n              <div className=\"spinner-grow\" role=\"status\">\n                <span className=\"visually-hidden\">Loading...</span>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"col col-12 col-lg-6 col-xl-6\">\n            <h3>Global Stats</h3>\n            <p>\n              <ul>\n                <li>Total votes: {stats.totalVotes}</li>\n                <li>Total purchases: {stats.numPurchases}</li>\n                <li>Total unique purchases: {stats.numUniqueCardsBought}</li>\n                <li>Total volume: {stats.nearVolume.toFixed(2)} NEAR</li>\n                <li>Total Art DAO profit: {stats.artDaoProfit.toFixed(2)} NEAR</li>\n                <li>Art DAO account ID: @{stats.artDaoId}</li>\n                <li>Total App commission: {stats.appCommission.toFixed(2)} NEAR</li>\n              </ul>\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default StatsPage;\n","import React from 'react';\nimport \"error-polyfill\";\nimport 'bootstrap/dist/js/bootstrap.bundle';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport \"./App.scss\";\nimport './gh-fork-ribbon.css';\nimport * as nearAPI from 'near-api-js'\nimport Logo from \"./images/logo.png\"\nimport DiscoverPage from \"./pages/Discover\";\nimport HomePage from \"./pages/Home\";\nimport {HashRouter as Router, Link, Route, Switch} from 'react-router-dom'\nimport {fromNear} from \"./components/BuyButton\";\nimport ls from \"local-storage\";\nimport CardPage from \"./pages/Card\";\nimport AccountPage from \"./pages/Account\";\nimport StatsPage from \"./pages/Stats\";\n\nconst IsMainnet = window.location.hostname === \"berry.cards\";\nconst TestNearConfig = {\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  archivalNodeUrl: 'https://rpc.testnet.internal.near.org',\n  contractName: 'dev-1614645337488-5371259',\n  walletUrl: 'https://wallet.testnet.near.org',\n};\n\nconst FetchLimit = 50;\n\nconst MainNearConfig = {\n  networkId: 'mainnet',\n  nodeUrl: 'https://rpc.mainnet.near.org',\n  archivalNodeUrl: 'https://rpc.mainnet.internal.near.org',\n  contractName: 'cards.berryclub.ek.near',\n  walletUrl: 'https://wallet.near.org',\n};\n\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig;\n\nconst mapAccount = (a) => {\n  return {\n    requests: a.requests,\n    numCards: a.num_cards,\n    purchaseVolume: fromNear(a.purchase_volume),\n    numPurchases: a.num_purchases,\n    saleProfit: fromNear(a.sale_profit),\n    numSales: a.num_sales,\n    numVotes: a.num_votes,\n  };\n}\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this._near = {};\n\n    this._near.lsKey = NearConfig.contractName + ':v01:';\n    this._near.lsKeyRecentCards = this._near.lsKey + \"recentCards\";\n\n    this.state = {\n      connected: false,\n      isNavCollapsed: true,\n      account: null,\n      requests: null,\n      recentCards: ls.get(this._near.lsKeyRecentCards) || [],\n    };\n\n    this._initNear().then(() => {\n      this.setState({\n        signedIn: !!this._near.accountId,\n        signedAccountId: this._near.accountId,\n        connected: true,\n      });\n    });\n  }\n\n\n  async _initNear() {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(Object.assign({deps: {keyStore}}, NearConfig));\n    this._near.keyStore = keyStore;\n    this._near.near = near;\n\n    this._near.walletConnection = new nearAPI.WalletConnection(near, NearConfig.contractName);\n    this._near.accountId = this._near.walletConnection.getAccountId();\n\n    this._near.account = this._near.walletConnection.account();\n    this._near.contract = new nearAPI.Contract(this._near.account, NearConfig.contractName, {\n      viewMethods: ['get_account', 'get_accounts', 'get_num_cards', 'get_top', 'get_rating', 'get_trade_data', 'get_card_info', 'get_account_cards'],\n      changeMethods: ['register_account', 'vote', 'buy_card'],\n    });\n\n    this._near.accounts = {};\n\n    this._near.getAccount = (accountId) => {\n      if (accountId in this._near.accounts) {\n        return this._near.accounts[accountId];\n      }\n      return this._near.accounts[accountId] = Promise.resolve((async () => {\n        const a = await this._near.contract.get_account({account_id: accountId});\n        const account = a ? mapAccount(a) : null;\n        if (account) {\n          account.fetchCards = () => {\n            if (account.cardFetching) {\n              return account.cardFetching;\n            }\n            const promises = [];\n            for (let i = 0; i < account.numCards; i += FetchLimit) {\n              promises.push(this._near.contract.get_account_cards({\n                account_id: accountId,\n                from_index: i,\n                limit: FetchLimit,\n              }));\n            }\n            return account.cardFetching = Promise.resolve((async () => {\n              return (await Promise.all(promises)).flat();\n            })());\n          };\n        }\n        return account;\n      })());\n    };\n\n    if (this._near.accountId) {\n      let account = await this._near.getAccount(this._near.accountId);\n      if (account === null) {\n        await this._near.contract.register_account();\n        delete this._near.accounts[this._near.accountId];\n        account = await this._near.getAccount(this._near.accountId);\n      }\n      this.setState({\n        account,\n        requests: account.requests,\n      });\n    }\n  }\n\n  async requestSignIn(e) {\n    e.preventDefault();\n    const appTitle = 'Berry Cards';\n    await this._near.walletConnection.requestSignIn(\n      NearConfig.contractName,\n      appTitle\n    )\n    return false;\n  }\n\n  async logOut() {\n    this._near.walletConnection.signOut();\n    this._near.accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      signedAccountId: this._accountId,\n    })\n  }\n\n  popRequest(c) {\n    const requests = this.state.requests.slice(1);\n    this.setState({\n      requests,\n    }, c);\n  }\n\n  addRequest(r, c) {\n    const requests = this.state.requests.slice(0);\n    requests.push(r);\n    this.setState({\n      requests,\n    }, c);\n  }\n\n  addRecentCard(cardId) {\n    let recentCards = this.state.recentCards.slice(0);\n    const index = recentCards.indexOf(cardId);\n    if (index !== -1) {\n      recentCards.splice(index, 1);\n    }\n    recentCards.unshift(cardId);\n    recentCards = recentCards.slice(0, 10);\n    ls.set(this._near.lsKeyRecentCards, recentCards);\n    this.setState({\n      recentCards\n    })\n  }\n\n  render() {\n    const passProps = {\n      _near: this._near,\n      updateState: (s, c) => this.setState(s, c),\n      popRequest: (c) => this.popRequest(c),\n      addRequest: (r, c) => this.addRequest(r, c),\n      addRecentCard: (cardId) => this.addRecentCard(cardId),\n      ...this.state\n    };\n    const header = !this.state.connected ? (\n      <div>Connecting... <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span></div>\n    ) : (this.state.signedIn ? (\n      <div>\n        <button\n          className=\"btn btn-outline-secondary\"\n          onClick={() => this.logOut()}>Sign out ({this.state.signedAccountId})</button>\n      </div>\n    ) : (\n      <div>\n        <button\n          className=\"btn btn-primary\"\n          onClick={(e) => this.requestSignIn(e)}>Sign in with NEAR Wallet</button>\n      </div>\n    ));\n\n    return (\n      <div className=\"App\">\n        <Router basename={process.env.PUBLIC_URL}>\n          <nav className=\"navbar navbar-expand-lg navbar-light bg-light mb-3\">\n            <div className=\"container-fluid\">\n              <Link className=\"navbar-brand\" to=\"/\" title=\"NEAR.fm\">\n                <img src={Logo} alt=\"Berry Cards\" className=\"d-inline-block align-middle\" />\n                [BETA] Berry Cards\n              </Link>\n              <button className=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\"\n                      data-bs-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\"\n                      aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span className=\"navbar-toggler-icon\"></span>\n              </button>\n              <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                <ul className=\"navbar-nav me-auto mb-2 mb-lg-0\">\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" aria-current=\"page\" to=\"/\">Home</Link>\n                  </li>\n                  {this.state.signedIn && (\n                    <li className=\"nav-item\">\n                      <Link className=\"nav-link\" aria-current=\"page\" to=\"/discover\">Discover</Link>\n                    </li>\n                  )}\n                  {this.state.signedIn && (\n                    <li className=\"nav-item\">\n                      <Link className=\"nav-link\" aria-current=\"page\"\n                            to={`/a/${this.state.signedAccountId}`}>Profile</Link>\n                    </li>\n                  )}\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" aria-current=\"page\" to=\"/stats\">Stats</Link>\n                  </li>\n                </ul>\n                <form className=\"d-flex\">\n                  {header}\n                </form>\n              </div>\n            </div>\n          </nav>\n\n          <a className=\"github-fork-ribbon right-bottom fixed\" href=\"https://github.com/evgenykuzyakov/berry-hot\" data-ribbon=\"Fork me on GitHub\"\n             title=\"Fork me on GitHub\">Fork me on GitHub</a>\n\n          <Switch>\n            <Route exact path={\"/\"}>\n              {this.state.signedIn ? (\n                <HomePage {...passProps}/>\n              ) : (\n                <DiscoverPage {...passProps}/>\n              )}\n            </Route>\n            <Route exact path={\"/discover\"}>\n              <DiscoverPage {...passProps}/>\n            </Route>\n            <Route exact path={\"/stats\"}>\n              <StatsPage {...passProps}/>\n            </Route>\n            <Route exact path={\"/a/:accountId\"}>\n              <AccountPage {...passProps} />\n            </Route>\n            <Route exact path={\"/c/:cardId\"}>\n              <CardPage {...passProps} />\n            </Route>\n          </Switch>\n        </Router>\n      </div>\n    )\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","module.exports = __webpack_public_path__ + \"static/media/logo.272328f4.png\";"],"sourceRoot":""}