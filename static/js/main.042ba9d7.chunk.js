(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{104:function(e,t,a){e.exports=a(197)},109:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){},134:function(e,t){},142:function(e,t){},157:function(e,t){},159:function(e,t){},191:function(e,t,a){},192:function(e,t,a){},197:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(93),s=a.n(c),i=(a(109),a(102)),l=a(1),o=a.n(l),u=a(18),d=a(94),m=a(95),b=a(103),p=a(101),f=(a(53),a(126),a(127),a(128),a(129),a(31)),v=a(96),h=a.n(v),g=a(13),E=(a(191),a(97)),N=a.n(E),k=a(98),w=a.n(k);var y=function(e){var t=Object(n.useState)(!0),a=Object(g.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(!1),l=Object(g.a)(i,2),o=l[0],u=l[1],d=e.cardReady,m=e.cardId;return Object(n.useEffect)((function(){s(!0),u(!1),d(!1);var e=new Image;e.src="https://wayback.berryclub.io/img/".concat(m),e.onload=function(){s(!1),d(!0)},e.onerror=function(e){u(!0),s(!1)}}),[m,d]),c?r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("div",{className:"spinner-grow",role:"status"},r.a.createElement("span",{className:"visually-hidden"},"Loading..."))):o?r.a.createElement("img",{className:e.className,src:w.a,alt:"The card is broken"}):r.a.createElement("img",{className:e.className,src:"https://wayback.berryclub.io/img/".concat(m),alt:"Card #".concat(m)})};var _=function(e){var t=Object(n.useState)(!0),a=Object(g.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)([]),l=Object(g.a)(i,2),d=l[0],m=l[1],b=Object(n.useState)(N()()),p=Object(g.a)(b,1)[0],f=Object(n.useCallback)(Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._near.contract.get_top({limit:100});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),[e._near]);Object(n.useEffect)((function(){e.connected&&(s(!0),f().then((function(e){m(e),s(!1)})))}),[e.connected,f]);var v=d.map((function(e){var t=Object(g.a)(e,2),a=t[0],n=t[1],c=parseFloat(a)/1e24,s="".concat(p,"-").concat(n);return r.a.createElement("div",{class:"card card-preview m-2",key:s},r.a.createElement(y,{className:"card-img-top",cardId:n,cardReady:function(){return!1}}),r.a.createElement("div",{class:"card-body"},r.a.createElement("h5",{class:"card-title"},"#",n),r.a.createElement("p",{class:"card-text"},"".concat(c.toFixed(2)," NEAR"))))}));return r.a.createElement("div",null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-md-center"},c?r.a.createElement("div",{className:"col col-12 col-lg-8 col-xl-6"},r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("div",{className:"spinner-grow",role:"status"},r.a.createElement("span",{className:"visually-hidden"},"Loading...")))):r.a.createElement("div",{className:"col"},v))))};a(192);var j=function(e){var t=Object(n.useState)(!1),a=Object(g.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(!1),l=Object(g.a)(i,2),d=l[0],m=l[1],b=Object(n.useState)(!1),p=Object(g.a)(b,2),f=p[0],v=p[1],h=function(){var t=Object(u.a)(o.a.mark((function t(a,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!c){t.next=2;break}return t.abrupt("return");case 2:if("SelectedLeft"!==n||d){t.next=4;break}return t.abrupt("return");case 4:if("SelectedRight"!==n||f){t.next=6;break}return t.abrupt("return");case 6:return a.preventDefault(),s(!0),t.next=10,e._near.contract.vote({request:e.request,response:n},"100000000000000");case 10:r=t.sent,e.updateState({request:r},(function(){return s(!1)}));case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("div",{className:"container"},e.request?r.a.createElement("div",null,r.a.createElement("div",{className:"row justify-content-md-center mb-3"},r.a.createElement("div",{className:"col col-sm-6"},r.a.createElement("div",{className:"card-picker".concat(c||!d?" disabled":""),onClick:function(e){return h(e,"SelectedLeft")}},r.a.createElement(y,{className:"img-fluid",cardId:e.request.left,cardReady:m}))),r.a.createElement("div",{className:"col col-sm-6"},r.a.createElement("div",{className:"card-picker".concat(c||!f?" disabled":""),onClick:function(e){return h(e,"SelectedRight")}},r.a.createElement(y,{className:"img-fluid",cardId:e.request.right,cardReady:v})))),r.a.createElement("div",{className:"row justify-content-md-center"},c?r.a.createElement("button",{disabled:!0,className:"btn btn-lg btn-secondary"},r.a.createElement("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"}),r.a.createElement("span",{className:"visually-hidden"},"Loading...")," ","Voting"):r.a.createElement("button",{className:"btn btn-lg btn-danger",onClick:function(e){return h(e,"Skipped")}},"Skip both cards"))):r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("div",{className:"spinner-grow",role:"status"},r.a.createElement("span",{className:"visually-hidden"},"Loading...")))))},O=a(32),S=a(3),x="berry.cards"===window.location.hostname?{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",archivalNodeUrl:"https://rpc.testnet.internal.near.org",contractName:"dev-1614470408772-5575011",walletUrl:"https://wallet.testnet.near.org"}:{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",archivalNodeUrl:"https://rpc.testnet.internal.near.org",contractName:"dev-1614554816701-8115451",walletUrl:"https://wallet.testnet.near.org"},I=function(e){Object(b.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._near={},n.state={connected:!1,isNavCollapsed:!0,request:null},n._initNear().then((function(){n.setState({signedIn:!!n._near.accountId,signedAccountId:n._near.accountId,connected:!0})})),n}return Object(m.a)(a,[{key:"_initNear",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new f.keyStores.BrowserLocalStorageKeyStore,e.next=3,f.connect(Object.assign({deps:{keyStore:t}},x));case 3:return a=e.sent,this._near.keyStore=t,this._near.near=a,this._near.walletConnection=new f.WalletConnection(a,x.contractName),this._near.accountId=this._near.walletConnection.getAccountId(),this._near.account=this._near.walletConnection.account(),e.next=11,this._near.account.connection.provider.block({finality:"final"});case 11:if(n=e.sent,this._near.lastBlockHeight=n.header.height,this._near.contract=new f.Contract(this._near.account,x.contractName,{viewMethods:["get_request","get_num_cards","get_top"],changeMethods:["new_request","vote"]}),!this._near.accountId){e.next=23;break}return e.next=17,this._near.contract.get_request({account_id:this._near.accountId});case 17:if(null!==(r=e.sent)){e.next=22;break}return e.next=21,this._near.contract.new_request();case 21:r=e.sent;case 22:this.setState({request:r});case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestSignIn",value:function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),"Berry Cards",e.next=4,this._near.walletConnection.requestSignIn(x.contractName,"Berry Cards");case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logOut",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._near.walletConnection.signOut(),this._near.accountId=null,this.setState({signedIn:!!this._accountId,signedAccountId:this._accountId});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object(i.a)({_near:this._near,updateState:function(t,a){return e.setState(t,a)}},this.state),a=this.state.connected?this.state.signedIn?r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-outline-secondary",onClick:function(){return e.logOut()}},"Sign out (",this.state.signedAccountId,")")):r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",onClick:function(t){return e.requestSignIn(t)}},"Sign in with NEAR Wallet")):r.a.createElement("div",null,"Connecting... ",r.a.createElement("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"}));return r.a.createElement("div",{className:"App"},r.a.createElement(O.a,{basename:""},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light mb-3"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement(O.b,{className:"navbar-brand",to:"/",title:"NEAR.fm"},r.a.createElement("img",{src:h.a,alt:"Berry Cards",className:"d-inline-block align-middle"}),"[TESTNET] Berry Cards"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(O.b,{className:"nav-link","aria-current":"page",to:"/"},"Home")),this.state.signedIn&&r.a.createElement("li",{className:"nav-item"},r.a.createElement(O.b,{className:"nav-link","aria-current":"page",to:"/discover"},"Discover"))),r.a.createElement("form",{className:"d-flex"},a)))),r.a.createElement("a",{className:"github-fork-ribbon right-bottom fixed",href:"https://github.com/evgenykuzyakov/berry-hot","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub"},"Fork me on GitHub"),r.a.createElement(S.c,null,r.a.createElement(S.a,{exact:!0,path:"/"},this.state.signedIn?r.a.createElement(j,t):r.a.createElement(_,t)),r.a.createElement(S.a,{exact:!0,path:"/discover"},r.a.createElement(_,t)))))}}]),a}(r.a.Component);s.a.render(r.a.createElement(I,null),document.getElementById("root"))},96:function(e,t,a){e.exports=a.p+"static/media/logo.f18e89c9.png"},98:function(e,t,a){e.exports=a.p+"static/media/broken-card.f18e89c9.png"}},[[104,1,2]]]);
//# sourceMappingURL=main.042ba9d7.chunk.js.map