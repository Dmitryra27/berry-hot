{"version":3,"sources":["images/tomato.png","images/avocado.gif","components/CardImage.js","components/BuyButton.js","components/Card.js","components/PriceButton.js","components/CardPreview.js","pages/Discover.js","pages/Home.js","pages/Card.js","App.js","index.js","images/logo.png"],"names":["module","exports","loadedCards","preloadCard","cardId","Image","src","CardImage","props","useState","loading","setLoading","badCard","setBadCard","cardReady","useEffect","a","onload","onerror","e","className","LoadingCard","alt","BrokenCard","fromNear","s","parseFloat","BuyButton","preventDefault","_near","contract","buy_card","card_id","price","disabled","signedIn","onClick","buyCard","toFixed","mapCardInfo","c","ownerId","owner_id","purchasePrice","purchase_price","purchaseTime","Date","purchase_time","volume","Card","cardInfo","setCardInfo","refreshTime","hidden","fetchInfo","useCallback","get_rating","rating","get_card_info","connected","then","datetime","role","PriceButton","setHidden","uuid","gkey","data-bs-toggle","data-bs-target","id","tabIndex","aria-labelledby","aria-hidden","type","data-bs-dismiss","aria-label","CardPreview","setRating","propsRating","fetchRating","to","DiscoverPage","feed","setFeed","fetchTop","get_top","limit","cards","map","key","HomePage","leftReady","setLeftReady","rightReady","setRightReady","Promise","resolve","votingPromise","voteRequest","requests","slice","forEach","nextRequest","left","right","vote","response","popRequest","request","newRequest","addRecentCard","addRequest","recentCards","length","CardPage","useParams","parseInt","NearConfig","window","location","hostname","networkId","nodeUrl","archivalNodeUrl","contractName","walletUrl","mapAccount","numCards","num_cards","purchaseVolume","purchase_volume","numPurchases","num_purchases","saleProfit","sale_profit","numSales","num_sales","numVotes","num_votes","App","lsKey","lsKeyRecentCards","state","isNavCollapsed","account","ls","get","_initNear","setState","accountId","signedAccountId","keyStore","nearAPI","BrowserLocalStorageKeyStore","Object","assign","deps","near","this","walletConnection","getAccountId","connection","provider","block","finality","lastBlockHeight","header","height","viewMethods","changeMethods","getAccount","get_account","account_id","register_account","requestSignIn","signOut","_accountId","r","push","index","indexOf","splice","unshift","set","passProps","updateState","logOut","basename","process","title","Logo","aria-controls","aria-expanded","aria-current","href","data-ribbon","exact","path","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.35e749cb.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/tomato.9239fac3.png\";","module.exports = __webpack_public_path__ + \"static/media/avocado.f0698336.gif\";","import React, {useEffect, useState} from 'react';\nimport BrokenCard from \"../images/tomato.png\"\nimport LoadingCard from \"../images/avocado.gif\"\n\nconst loadedCards = {};\n\nfunction preloadCard(cardId) {\n  if (cardId in loadedCards) {\n    return;\n  }\n  loadedCards[cardId] = true;\n  let a = new Image();\n  a.src = `https://wayback.berryclub.io/img/${cardId}`;\n}\n\nfunction CardImage(props) {\n  const [loading, setLoading] = useState(true);\n  const [badCard, setBadCard] = useState(false);\n\n  const cardReady = props.cardReady;\n  const cardId = props.cardId;\n\n  useEffect(() => {\n    setLoading(true);\n    setBadCard(false);\n    cardReady(false);\n    let a = new Image();\n    a.src = `https://wayback.berryclub.io/img/${cardId}`;\n    a.onload = () => {\n      setLoading(false);\n      cardReady(true);\n    }\n    a.onerror = (e) => {\n      setBadCard(true);\n      setLoading(false);\n    }\n  }, [cardId, cardReady])\n\n  return loading ? (\n    <img className={props.className} src={LoadingCard} alt={`The card #${cardId} is loading`}/>\n  ) : badCard ? (\n    <img className={props.className} src={BrokenCard} alt={`The card #${cardId} is broken`}/>\n  ) : (\n    <img className={props.className} src={`https://wayback.berryclub.io/img/${cardId}`} alt={`Card #${cardId}`}/>\n  );\n}\n\nexport { preloadCard, CardImage };\n","import React from 'react';\n\nconst fromNear = (s) => parseFloat(s) / 1e24;\n\nfunction BuyButton(props) {\n  async function buyCard(e) {\n    e.preventDefault();\n    await props._near.contract.buy_card({card_id: props.cardId}, \"100000000000000\", props.price)\n  }\n\n  return (\n    <button className=\"btn btn-success\" disabled={!props.signedIn} onClick={(e) => buyCard(e)}>\n      Buy for {fromNear(props.price).toFixed(2)} NEAR\n    </button>\n  );\n}\n\nexport { fromNear, BuyButton };\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {BuyButton, fromNear} from \"./BuyButton\";\nimport {CardImage, preloadCard} from \"./CardImage\";\nimport TimeAgo from \"timeago-react\";\n\nconst mapCardInfo = (c) => {\n  return c ? {\n    ownerId: c.owner_id,\n    purchasePrice: fromNear(c.purchase_price),\n    purchaseTime: new Date(parseFloat(c.purchase_time) / 1e6),\n    volume: fromNear(c.volume),\n  } : {\n    ownerId: null,\n    purchasePrice: 0,\n    purchaseTime: null,\n    volume: 0,\n  };\n}\n\nfunction Card(props) {\n  const [cardInfo, setCardInfo] = useState(null);\n  const cardId = props.cardId;\n  const refreshTime = props.refreshTime;\n  const hidden = props.hidden;\n\n  const fetchInfo = useCallback(async () => {\n    const rating = await props._near.contract.get_rating({\n      card_id: cardId,\n    })\n    const cardInfo = mapCardInfo(await props._near.contract.get_card_info({\n      card_id: cardId,\n    }));\n    cardInfo.refreshTime = refreshTime;\n    cardInfo.rating = rating;\n    return cardInfo;\n  }, [props._near, cardId, refreshTime])\n\n  useEffect(() => {\n    if (props.connected && !hidden) {\n      preloadCard(cardId);\n      fetchInfo().then(setCardInfo)\n    }\n  }, [props.connected, fetchInfo, cardId, hidden])\n\n  return cardInfo ? (\n    <div className=\"card m-2\">\n      <CardImage className=\"card-img-top\" cardId={cardId} cardReady={() => false}/>\n      <div className=\"card-body text-start\">\n        <h3>#{cardId}</h3>\n        {cardInfo.ownerId ? (\n          <div>\n            <p>\n              Owned by @{cardInfo.ownerId}<br/>\n              Purchased <TimeAgo datetime={cardInfo.purchaseTime} /><br/>\n              Purchased for {cardInfo.purchasePrice.toFixed(2)} NEAR<br/>\n            </p>\n          </div>\n        ) : (\n          <div>\n            <p>\n              Not owned by anyone.\n            </p>\n          </div>\n        )}\n      </div>\n      <div className=\"card-footer\">\n        <p className=\"card-text text-center\">\n          <BuyButton {...props} cardId={cardId} price={cardInfo.rating} />\n        </p>\n      </div>\n    </div>\n  ) : (\n    <div className=\"card m-2\">\n      <div className=\"d-flex justify-content-center\">\n        <div className=\"spinner-grow\" role=\"status\">\n          <span className=\"visually-hidden\">Loading...</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Card;\n","import React, {useState} from 'react';\nimport {fromNear} from \"./BuyButton\";\nimport Card from \"./Card\";\nimport uuid from \"react-uuid\";\n\nfunction PriceButton(props) {\n  const [hidden, setHidden] = useState(true);\n  const [gkey] = useState(uuid());\n\n  return (\n    <div>\n      <button\n        className=\"btn btn-success\" disabled={!props.signedIn}\n        data-bs-toggle=\"modal\"\n        data-bs-target={`#card-modal-${gkey}`}\n        onClick={(e) => setHidden(false)}\n      >\n        {fromNear(props.price).toFixed(2)} NEAR\n      </button>\n      <div className=\"modal fade\" id={`card-modal-${gkey}`} tabIndex=\"-1\" aria-labelledby={`card-label-${gkey}`} aria-hidden={true}>\n        <div className=\"modal-dialog modal-dialog-centered\">\n          <div className=\"modal-content\">\n            <div className=\"modal-header\">\n              <h5 className=\"modal-title\" id={`card-label-${gkey}`}>Card #{props.cardId}</h5>\n              <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n            </div>\n            <div className=\"modal-body\">\n              <Card {...props} hidden={hidden} />\n            </div>\n            <div className=\"modal-footer\">\n              <button type=\"button\" className=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default PriceButton;\n","import \"./CardPreview.scss\"\nimport React, {useCallback, useEffect, useState} from 'react';\nimport {CardImage} from \"./CardImage\";\nimport {Link} from \"react-router-dom\";\nimport PriceButton from \"./PriceButton\";\n\nfunction CardPreview(props) {\n  const [rating, setRating] = useState(props.rating);\n  const cardId = props.cardId;\n  const propsRating = props.rating;\n\n  const fetchRating = useCallback(async () => {\n    return await props._near.contract.get_rating({\n      card_id: cardId,\n    })\n  }, [props._near, cardId])\n\n  useEffect(() => {\n    if (props.connected) {\n      if (!propsRating) {\n        fetchRating().then(setRating)\n      } else {\n        setRating(propsRating)\n      }\n    }\n  }, [props.connected, propsRating, fetchRating])\n\n  return props.cardId ? (\n    <div className=\"card card-preview m-2\">\n      <Link to={`/c/${cardId}`}>\n        <CardImage className=\"card-img-top\" cardId={cardId} cardReady={() => false}/>\n      </Link>\n      <div className=\"card-body\">\n        #{cardId}\n      </div>\n      <div className=\"card-footer text-center\">\n        <PriceButton {...props} cardId={cardId} price={rating} />\n      </div>\n    </div>\n  ) : (\n    <div className=\"card card-preview m-2\">\n     <div className=\"d-flex justify-content-center\">\n        <div className=\"spinner-grow\" role=\"status\">\n          <span className=\"visually-hidden\">Loading...</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CardPreview;\n","import \"./Discover.scss\";\nimport React, {useCallback, useEffect, useState} from 'react';\nimport uuid from \"react-uuid\";\nimport CardPreview from \"../components/CardPreview\";\n\nconst FetchLimit = 40;\n\nfunction DiscoverPage(props) {\n  const [loading, setLoading] = useState(true);\n  const [feed, setFeed] = useState([]);\n  const [gkey] = useState(uuid())\n\n  const fetchTop = useCallback(async () => {\n    // const numCards = await props._near.contract.get_num_cards();\n    return await props._near.contract.get_top({\n      limit: FetchLimit,\n    })\n  }, [props._near])\n\n  useEffect(() => {\n    if (props.connected) {\n      setLoading(true);\n      fetchTop().then((feed) => {\n        setFeed(feed);\n        setLoading(false);\n      })\n    }\n  }, [props.connected, fetchTop])\n\n  const cards = feed.map(([rating, cardId]) => {\n    const key = `${gkey}-${cardId}`;\n    return (\n      <CardPreview {...props} key={key} cardId={cardId} rating={rating} />\n    );\n  })\n\n  return (\n    <div>\n      <div className=\"container\">\n        <div className=\"row justify-content-md-center\">\n          {loading ? (\n            <div className=\"col col-12 col-lg-8 col-xl-6\">\n              <div className=\"d-flex justify-content-center\">\n                <div className=\"spinner-grow\" role=\"status\">\n                  <span className=\"visually-hidden\">Loading...</span>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"col\">\n              {cards}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default DiscoverPage;\n","import \"./Home.scss\";\nimport React, {useState} from 'react';\nimport { CardImage, preloadCard } from \"../components/CardImage\";\nimport CardPreview from \"../components/CardPreview\";\nimport uuid from \"react-uuid\";\n\nconst SelectedLeft = \"SelectedLeft\";\nconst SelectedRight = \"SelectedRight\";\nconst Skipped = \"Skipped\";\n\nfunction HomePage(props) {\n  const [leftReady, setLeftReady] = useState(false);\n  const [rightReady, setRightReady] = useState(false);\n  const [votingPromise] = useState(Promise.resolve());\n  const [gkey] = useState(uuid())\n\n  const voteRequest = props.requests ? props.requests[0] : null;\n\n  if (props.requests) {\n    props.requests.slice(1).forEach((nextRequest) => {\n      preloadCard(nextRequest.left);\n      preloadCard(nextRequest.right);\n    });\n  }\n\n  const vote = async (e, voteRequest, response) => {\n    e.preventDefault();\n    if (response === SelectedLeft && !leftReady) {\n      return;\n    }\n    if (response === SelectedRight && !rightReady) {\n      return;\n    }\n    props.popRequest();\n    votingPromise.then(async () => {\n      const newRequest = await props._near.contract.vote({\n        request: voteRequest,\n        response,\n      }, \"100000000000000\");\n      if (response === SelectedLeft || response === SelectedRight) {\n        const cardId = response === SelectedLeft ? voteRequest.left : voteRequest.right;\n        props.addRecentCard(cardId);\n      }\n      props.addRequest(newRequest);\n    });\n  }\n\n  const cards = props.recentCards.map((cardId) => {\n    const key = `${gkey}-${cardId}`;\n    return (\n      <CardPreview {...props} key={key} cardId={cardId} />\n    );\n  })\n\n  return (\n    <div>\n      <div className=\"container\">\n        {voteRequest ? (\n          <div>\n            <div className=\"row justify-content-md-center mb-3\">\n              <div className=\"col col-sm-6\">\n                <div\n                  className={`card-picker${!leftReady ? \" disabled\": \"\"}`}\n                  onClick={(e) => vote(e, voteRequest, SelectedLeft)}\n                >\n                  <CardImage className=\"img-fluid\" cardId={voteRequest.left} cardReady={setLeftReady}/>\n                </div>\n              </div>\n              <div className=\"col col-sm-6\">\n                <div\n                  className={`card-picker${!rightReady ? \" disabled\": \"\"}`}\n                  onClick={(e) => vote(e, voteRequest, SelectedRight)}\n                >\n                  <CardImage className=\"img-fluid\" cardId={voteRequest.right} cardReady={setRightReady}/>\n                </div>\n              </div>\n            </div>\n            <div className=\"row justify-content-md-center mb-3\">\n              <button\n                className=\"btn btn-lg btn-danger\"\n                onClick={(e) => vote(e, voteRequest, Skipped)}\n              >Skip both cards</button>\n            </div>\n          </div>\n        ) : (\n          <div className=\"d-flex justify-content-center\">\n            <div className=\"spinner-grow\" role=\"status\">\n              <span className=\"visually-hidden\">Loading...</span>\n            </div>\n          </div>\n        )}\n        <div className=\"row justify-content-md-center mb-3\">\n          {(cards.length > 0) && (\n            <div>\n              <h3>Recent votes</h3>\n              {cards}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default HomePage;\n","import React from 'react';\nimport {useParams} from \"react-router\";\nimport Card from \"../components/Card\";\n\nfunction CardPage(props) {\n  const { cardId } = useParams();\n\n  return (\n    <div className=\"container\">\n      <div className=\"row justify-content-md-center\">\n        <div className=\"col col-12 col-lg-8 col-xl-6\">\n          <Card {...props} cardId={parseInt(cardId)} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CardPage;\n","import React from 'react';\nimport \"error-polyfill\";\nimport 'bootstrap/dist/js/bootstrap.bundle';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport \"./App.scss\";\nimport './gh-fork-ribbon.css';\nimport * as nearAPI from 'near-api-js'\nimport Logo from \"./images/logo.png\"\nimport DiscoverPage from \"./pages/Discover\";\nimport HomePage from \"./pages/Home\";\nimport {HashRouter as Router, Link, Route, Switch} from 'react-router-dom'\nimport {fromNear} from \"./components/BuyButton\";\nimport ls from \"local-storage\";\nimport CardPage from \"./pages/Card\";\n\nconst IsMainnet = window.location.hostname === \"berry.cards\";\nconst TestNearConfig = {\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  archivalNodeUrl: 'https://rpc.testnet.internal.near.org',\n  contractName: 'dev-1614562672208-5026434',\n  walletUrl: 'https://wallet.testnet.near.org',\n};\n\nconst MainNearConfig = {\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  archivalNodeUrl: 'https://rpc.testnet.internal.near.org',\n  contractName: 'dev-1614562672208-5026434',\n  walletUrl: 'https://wallet.testnet.near.org',\n};\n\n// const MainNearConfig = {\n//   networkId: 'mainnet',\n//   nodeUrl: 'https://rpc.mainnet.near.org',\n//   contractName: 'berryclub.ek.near',\n//   walletUrl: 'https://wallet.near.org',\n// };\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig;\n\nconst mapAccount = (a) => {\n  return {\n    requests: a.requests,\n    numCards: a.num_cards,\n    purchaseVolume: fromNear(a.purchase_volume),\n    numPurchases: a.num_purchases,\n    saleProfit: fromNear(a.sale_profit),\n    numSales: a.num_sales,\n    numVotes: a.num_votes,\n  };\n}\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this._near = {};\n\n    this._near.lsKey = NearConfig.contractName + ':v01:';\n    this._near.lsKeyRecentCards = this._near.lsKey + \"recentCards\";\n\n    this.state = {\n      connected: false,\n      isNavCollapsed: true,\n      account: null,\n      requests: null,\n      recentCards: ls.get(this._near.lsKeyRecentCards) || [],\n    };\n\n    this._initNear().then(() => {\n      this.setState({\n        signedIn: !!this._near.accountId,\n        signedAccountId: this._near.accountId,\n        connected: true,\n      });\n    });\n  }\n\n\n  async _initNear() {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(Object.assign({deps: {keyStore}}, NearConfig));\n    this._near.keyStore = keyStore;\n    this._near.near = near;\n\n    this._near.walletConnection = new nearAPI.WalletConnection(near, NearConfig.contractName);\n    this._near.accountId = this._near.walletConnection.getAccountId();\n\n    this._near.account = this._near.walletConnection.account();\n    const block = await this._near.account.connection.provider.block({ finality: 'final' });\n    this._near.lastBlockHeight = block.header.height;\n    this._near.contract = new nearAPI.Contract(this._near.account, NearConfig.contractName, {\n      viewMethods: ['get_account', 'get_accounts', 'get_num_cards', 'get_top', 'get_rating', 'get_trade_data', 'get_card_info'],\n      changeMethods: ['register_account', 'vote', 'buy_card'],\n    });\n\n    this._near.getAccount = async (accountId) => {\n      const a = await this._near.contract.get_account({account_id: accountId});\n      return a ? mapAccount(a) : null;\n    };\n\n    if (this._near.accountId) {\n      let account = await this._near.getAccount(this._near.accountId);\n      if (account === null) {\n        account = mapAccount(await this._near.contract.register_account());\n      }\n      this.setState({\n        account,\n        requests: account.requests,\n      });\n    }\n  }\n\n  async requestSignIn(e) {\n    e.preventDefault();\n    const appTitle = 'Berry Cards';\n    await this._near.walletConnection.requestSignIn(\n      NearConfig.contractName,\n      appTitle\n    )\n    return false;\n  }\n\n  async logOut() {\n    this._near.walletConnection.signOut();\n    this._near.accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      signedAccountId: this._accountId,\n    })\n  }\n\n  popRequest(c) {\n    const requests = this.state.requests.slice(1);\n    this.setState({\n      requests,\n    }, c);\n  }\n\n  addRequest(r, c) {\n    const requests = this.state.requests.slice(0);\n    requests.push(r);\n    this.setState({\n      requests,\n    }, c);\n  }\n\n  addRecentCard(cardId) {\n    let recentCards = this.state.recentCards.slice(0);\n    const index = recentCards.indexOf(cardId);\n    if (index !== -1) {\n      recentCards.splice(index, 1);\n    }\n    recentCards.unshift(cardId);\n    recentCards = recentCards.slice(0, 10);\n    ls.set(this._near.lsKeyRecentCards, recentCards);\n    this.setState({\n      recentCards\n    })\n  }\n\n  render() {\n    const passProps = {\n      _near: this._near,\n      updateState: (s, c) => this.setState(s, c),\n      popRequest: (c) => this.popRequest(c),\n      addRequest: (r, c) => this.addRequest(r, c),\n      addRecentCard: (cardId) => this.addRecentCard(cardId),\n      ...this.state\n    };\n    const header = !this.state.connected ? (\n      <div>Connecting... <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span></div>\n    ) : (this.state.signedIn ? (\n      <div>\n        <button\n          className=\"btn btn-outline-secondary\"\n          onClick={() => this.logOut()}>Sign out ({this.state.signedAccountId})</button>\n      </div>\n    ) : (\n      <div>\n        <button\n          className=\"btn btn-primary\"\n          onClick={(e) => this.requestSignIn(e)}>Sign in with NEAR Wallet</button>\n      </div>\n    ));\n\n    return (\n      <div className=\"App\">\n        <Router basename={process.env.PUBLIC_URL}>\n          <nav className=\"navbar navbar-expand-lg navbar-light bg-light mb-3\">\n            <div className=\"container-fluid\">\n              <Link className=\"navbar-brand\" to=\"/\" title=\"NEAR.fm\">\n                <img src={Logo} alt=\"Berry Cards\" className=\"d-inline-block align-middle\" />\n                [TESTNET] Berry Cards\n              </Link>\n              <button className=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\"\n                      data-bs-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\"\n                      aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span className=\"navbar-toggler-icon\"></span>\n              </button>\n              <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                <ul className=\"navbar-nav me-auto mb-2 mb-lg-0\">\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" aria-current=\"page\" to=\"/\">Home</Link>\n                  </li>\n                  {this.state.signedIn && (\n                    <li className=\"nav-item\">\n                      <Link className=\"nav-link\" aria-current=\"page\" to=\"/discover\">Discover</Link>\n                    </li>\n                  )}\n                </ul>\n                <form className=\"d-flex\">\n                  {header}\n                </form>\n              </div>\n            </div>\n          </nav>\n\n          <a className=\"github-fork-ribbon right-bottom fixed\" href=\"https://github.com/evgenykuzyakov/berry-hot\" data-ribbon=\"Fork me on GitHub\"\n             title=\"Fork me on GitHub\">Fork me on GitHub</a>\n\n          <Switch>\n            <Route exact path={\"/\"}>\n              {this.state.signedIn ? (\n                <HomePage {...passProps}/>\n              ) : (\n                <DiscoverPage {...passProps}/>\n              )}\n            </Route>\n            <Route exact path={\"/discover\"}>\n              <DiscoverPage {...passProps}/>\n            </Route>\n            <Route exact path={\"/c/:cardId\"}>\n              <CardPage {...passProps} />\n            </Route>\n          </Switch>\n        </Router>\n      </div>\n    )\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","module.exports = __webpack_public_path__ + \"static/media/logo.f18e89c9.png\";"],"sourceRoot":""}